

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Java client library &mdash; Central Dogma 0.21.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="stylesheet" href="_static/overrides.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Central Dogma 0.21.1 documentation" href="index.html"/>
        <link rel="next" title="Better configuration change workflow with Git-to-CD mirroring" href="mirroring.html"/>
        <link rel="prev" title="Command-line client" href="client-cli.html"/>
  <script src="_static/center_page.js"></script>
   


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/central_dogma.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.21
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setting up</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-cli.html">Command-line client</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Java client library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#adding-centraldogma-client-as-a-dependency">Adding <code class="docutils literal highlight highlight-default"><span></span><span class="n">centraldogma</span><span class="o">-</span><span class="n">client</span></code> as a dependency</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-client">Creating a client</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-a-file">Getting a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pushing-a-commit">Pushing a commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#watching-a-file">Watching a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-multiple-hosts">Specifying multiple hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-client-profiles">Using client profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spring-boot-integration">Spring Boot integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#read-the-javadoc">Read the Javadoc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mirroring.html">Better configuration change workflow with Git-to-CD mirroring</a></li>
<li class="toctree-l1"><a class="reference internal" href="known-issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/releases">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="apidocs/index.html#://">API documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="xref/index.html#://">Source cross-reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/issues?q=label%3Aquestion-answered">Questions and answers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma">Fork me at GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/blob/master/CONTRIBUTING.md">Contributing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Central Dogma</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Java client library</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/line/centraldogma/blob/master/site/src/sphinx/client-java.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="java-client-library">
<span id="client-java"></span><h1>Java client library<a class="headerlink" href="#java-client-library" title="Permalink to this headline">¶</a></h1>
<p>The Java client library is the first class client implementation that provides the access to all operations
exposed by a Central Dogma server.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Keep <a class="reference external" href="apidocs/index.html">the API documentation</a> open in another browser tab. You’ll find it to be a very useful companion.</p>
</div>
<div class="section" id="adding-centraldogma-client-as-a-dependency">
<h2>Adding <code class="docutils literal highlight highlight-default"><span></span><span class="n">centraldogma</span><span class="o">-</span><span class="n">client</span></code> as a dependency<a class="headerlink" href="#adding-centraldogma-client-as-a-dependency" title="Permalink to this headline">¶</a></h2>
<p>Gradle:</p>
<pre class="literal-block">
...
dependencies {
    ...
    compile 'com.linecorp.centraldogma:centraldogma-client:0.21.1'
    ...
}
...
</pre>
<p>Maven:</p>
<pre class="literal-block">
...
&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;com.linecorp.centraldogma&lt;/groupId&gt;
    &lt;artifactId&gt;centraldogma-client&lt;/artifactId&gt;
    &lt;version&gt;0.21.1&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;
...
</pre>
</div>
<div class="section" id="creating-a-client">
<h2>Creating a client<a class="headerlink" href="#creating-a-client" title="Permalink to this headline">¶</a></h2>
<p>First, we should create a new instance of <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogma</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.client.CentralDogma</span><span class="o">;</span>

<span class="c1">// The default port 36462 is used if unspecified.</span>
<span class="n">CentralDogma</span> <span class="n">dogma</span> <span class="o">=</span> <span class="n">CentralDogma</span><span class="o">.</span><span class="na">forHost</span><span class="o">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="o">);</span>
<span class="c1">// You can specify an alternative port as well:</span>
<span class="n">CentralDogma</span> <span class="n">dogma2</span> <span class="o">=</span> <span class="n">CentralDogma</span><span class="o">.</span><span class="na">forHost</span><span class="o">(</span><span class="s">&quot;example.com&quot;</span><span class="o">,</span> <span class="mi">8888</span><span class="o">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Internally, the client uses <a class="reference external" href="https://line.github.io/armeria/">Armeria</a> as its networking layer. You may want to use <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogmaBuilder</span></code>
to customize the client settings, such as specifying alternative Armeria <code class="docutils literal highlight highlight-default"><span></span><span class="n">ClientFactory</span></code> or configuring
Armeria <code class="docutils literal highlight highlight-default"><span></span><span class="n">ClientBuilder</span></code>.</p>
</div>
</div>
<div class="section" id="getting-a-file">
<h2>Getting a file<a class="headerlink" href="#getting-a-file" title="Permalink to this headline">¶</a></h2>
<p>Once a client is created, you can get a file from a repository:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Entry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.EntryType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Revision</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Query</span><span class="o">;</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">future</span> <span class="o">=</span>
        <span class="n">dogma</span><span class="o">.</span><span class="na">getFile</span><span class="o">(</span><span class="s">&quot;myProj&quot;</span><span class="o">,</span> <span class="s">&quot;myRepo&quot;</span><span class="o">,</span> <span class="n">Revision</span><span class="o">.</span><span class="na">HEAD</span><span class="o">,</span> <span class="n">Query</span><span class="o">.</span><span class="na">identity</span><span class="o">(</span><span class="s">&quot;/a.txt&quot;</span><span class="o">));</span>

<span class="n">Entry</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
<span class="k">assert</span> <span class="n">entry</span><span class="o">.</span><span class="na">type</span><span class="o">()</span> <span class="o">==</span> <span class="n">EntryType</span><span class="o">.</span><span class="na">TEXT</span>
<span class="k">assert</span> <span class="n">entry</span><span class="o">.</span><span class="na">content</span><span class="o">()</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">;</span> <span class="c1">// Text file&#39;s content type is String.</span>
<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">content</span><span class="o">());</span>
</pre></div>
</div>
<p>The <code class="docutils literal highlight highlight-default"><span></span><span class="n">getFile</span><span class="p">()</span></code> call above will fetch the latest revision of <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">a</span><span class="o">.</span><span class="n">txt</span></code> because we specified <code class="docutils literal highlight highlight-default"><span></span><span class="n">Revision</span><span class="o">.</span><span class="n">HEAD</span></code>
which is equal to <code class="docutils literal highlight highlight-default"><span></span><span class="n">new</span> <span class="n">Revision</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></code>. If you want to fetch a specific revision, you can specify the revision
you desire. e.g. <code class="docutils literal highlight highlight-default"><span></span><span class="n">new</span> <span class="n">Revision</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span></code> or <code class="docutils literal highlight highlight-default"><span></span><span class="n">new</span> <span class="n">Revision</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Not sure what the meaning of a negative revision number is? Read <a class="reference internal" href="concepts.html#concepts"><span class="std std-ref">Concepts</span></a>.</p>
</div>
<p>Note that we used <code class="docutils literal highlight highlight-default"><span></span><span class="n">Query</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span></code>, which tells Central Dogma to fetch the content in verbatim.
Alternatively, if the file is JSON, you can use <code class="docutils literal highlight highlight-default"><span></span><span class="n">Query</span><span class="o">.</span><span class="n">ofJsonPath</span><span class="p">()</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.JsonNode</span><span class="o">;</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">JsonNode</span><span class="o">&gt;&gt;</span> <span class="n">future</span> <span class="o">=</span>
        <span class="n">dogma</span><span class="o">.</span><span class="na">getFile</span><span class="o">(</span><span class="s">&quot;myProj&quot;</span><span class="o">,</span> <span class="s">&quot;myRepo&quot;</span><span class="o">,</span> <span class="n">Revision</span><span class="o">.</span><span class="na">HEAD</span><span class="o">,</span>
                      <span class="n">Query</span><span class="o">.</span><span class="na">ofJsonPath</span><span class="o">(</span><span class="s">&quot;/b.json&quot;</span><span class="o">,</span> <span class="s">&quot;$.someValue&quot;</span><span class="o">));</span>
</pre></div>
</div>
<p>Did you notice the return type changed slightly? The type parameter of <code class="docutils literal highlight highlight-default"><span></span><span class="n">Entry</span></code> is not <code class="docutils literal highlight highlight-default"><span></span><span class="n">Object</span></code> anymore but
<code class="docutils literal highlight highlight-default"><span></span><span class="n">JsonNode</span></code> (from <a class="reference external" href="https://github.com/FasterXML/jackson">Jackson</a>), because we know we are fetching a JSON
file. Central Dogma server will apply the JSON path expression <code class="docutils literal highlight highlight-default"><span></span>$.someValue</code> to the content of <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">json</span></code>
and return the query result to the client. For example, if <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">json</span></code> contains the following:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">&quot;someValue&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="nt">&quot;otherValue&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>You would get:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="mi">42</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Central Dogma uses <a class="reference external" href="https://github.com/json-path/JsonPath">Jayway’s JSON path implementation</a>.
Refer to their project page for syntax, example and the list of supported functions.</p>
</div>
</div>
<div class="section" id="pushing-a-commit">
<h2>Pushing a commit<a class="headerlink" href="#pushing-a-commit" title="Permalink to this headline">¶</a></h2>
<p>You can also push a commit into a repository programmatically:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Author</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Change</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.common.Commit</span><span class="o">;</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">Commit</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span>
        <span class="n">dogma</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;myProj&quot;</span><span class="o">,</span> <span class="s">&quot;myRepo&quot;</span><span class="o">,</span> <span class="n">Revision</span><span class="o">.</span><span class="na">HEAD</span><span class="o">,</span>
                   <span class="k">new</span> <span class="n">Author</span><span class="o">(</span><span class="s">&quot;John Doe&quot;</span><span class="o">,</span> <span class="s">&quot;john@doe.com&quot;</span><span class="o">),</span>
                   <span class="s">&quot;Add /c.json and remove /b.json&quot;</span><span class="o">,</span>
                   <span class="n">Change</span><span class="o">.</span><span class="na">ofUpsert</span><span class="o">(</span><span class="s">&quot;/c.json&quot;</span><span class="o">,</span> <span class="s">&quot;{ \&quot;foo\&quot;: \&quot;bar\&quot; }&quot;</span><span class="o">),</span>
                   <span class="n">Change</span><span class="o">.</span><span class="na">ofRemoval</span><span class="o">(</span><span class="s">&quot;/b.json&quot;</span><span class="o">));</span>

<span class="n">Commit</span> <span class="n">commit</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Pushed a commit &quot;</span> <span class="o">+</span> <span class="n">commit</span><span class="o">.</span><span class="na">revision</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; at &quot;</span> <span class="o">+</span> <span class="n">commit</span><span class="o">.</span><span class="na">whenAsText</span><span class="o">());</span>
</pre></div>
</div>
<p>In this example, we pushed a commit that contains two changes: one that adds <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">c</span><span class="o">.</span><span class="n">json</span></code> and the other that
removes <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">json</span></code>.</p>
<p>Note that we specified <code class="docutils literal highlight highlight-default"><span></span><span class="n">Revision</span><span class="o">.</span><span class="n">HEAD</span></code> as the base revision. It means this commit is against the latest
commit in the repository <code class="docutils literal highlight highlight-default"><span></span><span class="n">myRepo</span></code>. Alternatively, you can specify an absolute revision so that you are
absolutely sure that nobody pushed a commit while you prepare yours: (pun intended 😉)</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.CompletionException</span><span class="o">;</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">Commit</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">dogma</span><span class="o">.</span><span class="na">push</span><span class="o">(...,</span> <span class="k">new</span> <span class="n">Revision</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="o">...);</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">future</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">CompletionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Throwable</span> <span class="n">cause</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getCause</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">cause</span> <span class="k">instanceof</span> <span class="n">CentralDogmaException</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CentralDogmaException</span> <span class="n">cde</span> <span class="o">=</span> <span class="o">(</span><span class="n">CentralDogmaException</span><span class="o">)</span> <span class="n">cause</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cde</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">==</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="na">CHANGE_CONFLICT</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Somebody pushed a commit newer than revision 3 or</span>
            <span class="c1">// our changes cannot be applied to the revision 3 cleanly.</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="watching-a-file">
<h2>Watching a file<a class="headerlink" href="#watching-a-file" title="Permalink to this headline">¶</a></h2>
<p>Some configuration properties are dynamic. They are changed often and they must be applied without restarting
the process. The client library provides an easy way to watch a file:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.client.Latest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.client.Watcher</span><span class="o">;</span>

<span class="n">Watcher</span><span class="o">&lt;</span><span class="n">JsonNode</span><span class="o">&gt;</span> <span class="n">watcher</span> <span class="o">=</span> <span class="n">dogma</span><span class="o">.</span><span class="na">fileWatcher</span><span class="o">(</span><span class="s">&quot;myProj&quot;</span><span class="o">,</span> <span class="s">&quot;myRepo&quot;</span><span class="o">,</span> <span class="n">Query</span><span class="o">.</span><span class="na">ofJsonPath</span><span class="o">(</span><span class="s">&quot;$.foo&quot;</span><span class="o">));</span>

<span class="c1">// Register a callback for changes.</span>
<span class="n">watcher</span><span class="o">.</span><span class="na">watch</span><span class="o">((</span><span class="n">revision</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Foo has been updated to &quot;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s">&quot; (revision: &quot;</span> <span class="o">+</span> <span class="n">revision</span> <span class="o">+</span> <span class="sc">&#39;)&#39;</span><span class="o">);</span>
<span class="o">});</span>

<span class="c1">// Alternatively, without using a callback:</span>
<span class="n">Latest</span><span class="o">&lt;</span><span class="n">JsonNode</span><span class="o">&gt;</span> <span class="n">latest</span> <span class="o">=</span> <span class="n">watcher</span><span class="o">.</span><span class="na">latest</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Current foo: &quot;</span> <span class="o">+</span> <span class="n">latest</span><span class="o">.</span><span class="na">value</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; (revision: &quot;</span> <span class="o">+</span> <span class="n">latest</span><span class="o">.</span><span class="na">revision</span><span class="o">()</span> <span class="o">+</span> <span class="sc">&#39;)&#39;</span><span class="o">);</span>
</pre></div>
</div>
<p>You would want to register a callback to the <code class="docutils literal highlight highlight-default"><span></span><span class="n">Watcher</span></code> or check the return value of <code class="docutils literal highlight highlight-default"><span></span><span class="n">Watcher</span><span class="o">.</span><span class="n">latest</span><span class="p">()</span></code>
periodically to apply the new settings to your application.</p>
</div>
<div class="section" id="specifying-multiple-hosts">
<h2>Specifying multiple hosts<a class="headerlink" href="#specifying-multiple-hosts" title="Permalink to this headline">¶</a></h2>
<p>You can use <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogmaBuilder</span></code> to add more than one host:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.client.CentralDogmaBuilder</span><span class="o">;</span>

<span class="n">CentralDogmaBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CentralDogmaBuilder</span><span class="o">();</span>
<span class="c1">// The default port 36462 is used if unspecified.</span>
<span class="n">builder</span><span class="o">.</span><span class="na">host</span><span class="o">(</span><span class="s">&quot;replica1.example.com&quot;</span><span class="o">);</span>
<span class="c1">// You can specify an alternative port number.</span>
<span class="n">builder</span><span class="o">.</span><span class="na">host</span><span class="o">(</span><span class="s">&quot;replica2.example.com&quot;</span><span class="o">,</span> <span class="mi">1234</span><span class="o">);</span>
<span class="n">CentralDogma</span> <span class="n">dogma</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="section" id="using-client-profiles">
<span id="id1"></span><h2>Using client profiles<a class="headerlink" href="#using-client-profiles" title="Permalink to this headline">¶</a></h2>
<p>You can load the list of the Central Dogma servers from <code class="docutils literal highlight highlight-default"><span></span><span class="o">.</span><span class="n">properties</span></code> resource file in the class path using
<code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogma</span><span class="o">.</span><span class="n">forProfile</span><span class="p">()</span></code> or <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogmaBuilder</span><span class="o">.</span><span class="n">profile</span><span class="p">()</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">CentralDogmauBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CentralDogmaBuilder</span><span class="o">();</span>
<span class="c1">// Loads the host list from /centraldogma-profile-beta.properties.</span>
<span class="n">builder</span><span class="o">.</span><span class="na">profile</span><span class="o">(</span><span class="s">&quot;beta&quot;</span><span class="o">);</span>
<span class="n">CentralDogma</span> <span class="n">dogma</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
<p>The resource path of the <code class="docutils literal highlight highlight-default"><span></span><span class="o">.</span><span class="n">properties</span></code> file is <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">centraldogma</span><span class="o">-</span><span class="n">profile</span><span class="o">-&lt;</span><span class="n">profile_name</span><span class="o">&gt;.</span><span class="n">properties</span></code> and its
content looks like the following:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># The default port 36462 is used if unspecified.</span>
<span class="na">centraldogma.hosts.0</span><span class="o">=</span><span class="s">replica1.beta.example.com</span>
<span class="c"># You can specify an alternative port number.</span>
<span class="na">centraldogma.hosts.1</span><span class="o">=</span><span class="s">replica2.beta.example.com:1234</span>
</pre></div>
</div>
<p>You may want to archive this file into a JAR file and distribute it via a Maven repository, so that your users
gets the up-to-date host list easily. For example, a user could put <code class="docutils literal highlight highlight-default"><span></span><span class="n">centraldogma</span><span class="o">-</span><span class="n">profiles</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="n">jar</span></code> into his
or her class path:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cat centraldogma-profile-beta.properties
centraldogma.host.0=...
...
$ cat centraldogma-profile-staging.properties
centraldogma.host.0=...
...
$ cat centraldogma-profile-release.properties
centraldogma.host.0=...
...
$ jar cvf centraldogma-profiles-1.0.jar centraldogma-profile-*.properties
added manifest
adding: centraldogma-profile-beta.properties
adding: centraldogma-profile-staging.properties
adding: centraldogma-profile-release.properties
</pre></div>
</div>
</div>
<div class="section" id="spring-boot-integration">
<h2>Spring Boot integration<a class="headerlink" href="#spring-boot-integration" title="Permalink to this headline">¶</a></h2>
<p>If you are using <a class="reference external" href="https://spring.io/">Spring Framework</a>, you can inject <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogma</span></code> client very easily.</p>
<ol class="arabic simple">
<li>Add <code class="docutils literal highlight highlight-default"><span></span><span class="n">centraldogma</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">autoconfigure</span></code> into your dependencies.</li>
<li>Add the client profile to your class path, as described in <a class="reference internal" href="#using-client-profiles"><span class="std std-ref">Using client profiles</span></a>.</li>
</ol>
<p>A new <code class="docutils literal highlight highlight-default"><span></span><span class="n">CentralDogma</span></code> client will be created and injected using your
<a class="reference external" href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html">Spring Boot profile</a>.
When more than one profile is active, the first matching one will be used. For example,
<code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">centraldogma</span><span class="o">-</span><span class="n">profile</span><span class="o">-</span><span class="n">dev</span><span class="o">.</span><span class="n">properties</span></code> will be tried first and then <code class="docutils literal highlight highlight-default"><span></span><span class="o">/</span><span class="n">centraldogma</span><span class="o">-</span><span class="n">profile</span><span class="o">-</span><span class="n">hsqldb</span><span class="o">.</span><span class="n">properties</span></code>
if your active Spring Boot profiles are <code class="docutils literal highlight highlight-default"><span></span><span class="n">dev</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="n">hsqldb</span></code>.</p>
<p>Once configured correctly, you would be able to run an application like the following:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.springframework.boot.CommandLineRunner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.linecorp.centraldogma.client.CentralDogma</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">MyApp</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// CentralDogma is injected automatically by CentralDogmaConfiguration.</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">CommandLineRunner</span> <span class="nf">commandLineRunner</span><span class="o">(</span><span class="n">CentralDogma</span> <span class="n">dogma</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">args</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dogma</span><span class="o">.</span><span class="na">listProjects</span><span class="o">().</span><span class="na">join</span><span class="o">());</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="read-the-javadoc">
<h2>Read the Javadoc<a class="headerlink" href="#read-the-javadoc" title="Permalink to this headline">¶</a></h2>
<p>Refer to <a class="reference external" href="apidocs/index.html?com/linecorp/centraldogma/client/CentralDogma.html">the API documentation of ‘CentralDogma’ class</a>
for the complete list of operations you can perform with a Central Dogma server, which should be definitely
much more than what this tutorial covers, such as fetching and watching multiple files.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mirroring.html" class="btn btn-neutral float-right" title="Better configuration change workflow with Git-to-CD mirroring" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="client-cli.html" class="btn btn-neutral" title="Command-line client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, LINE Corporation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.21.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
  <div class="github-fork-ribbon-wrapper right">
    <div class="github-fork-ribbon">
      <a href="https://github.com/line/centraldogma">Fork me at GitHub</a>
    </div>
  </div>
  <script type="text/javascript" src="_static/add_badges.js"></script>
   


</body>
</html>